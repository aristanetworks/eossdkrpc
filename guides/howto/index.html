
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Arista's EOS SDK RPC documentation">
      
      
        <meta name="author" content="Arista Networks">
      
      
      
        <link rel="prev" href="../errorhandling/">
      
      
        <link rel="next" href="../limitations/">
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>EosSdkRpc HOWTO - EOS SDK RPC documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#eossdkrpc-howto" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="EOS SDK RPC documentation" class="md-header__button md-logo" aria-label="EOS SDK RPC documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            EOS SDK RPC documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              EosSdkRpc HOWTO
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aristanetworks/eossdkrpc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    eossdkrpc on GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Guides

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../api-reference/" class="md-tabs__link">
          
  
  
    
  
  API reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../faq/" class="md-tabs__link">
        
  
  
    
  
  FAQ

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="EOS SDK RPC documentation" class="md-nav__button md-logo" aria-label="EOS SDK RPC documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    EOS SDK RPC documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aristanetworks/eossdkrpc" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    eossdkrpc on GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aclrules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exposing the RPC port
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Basic configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../errorhandling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Error handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    EosSdkRpc HOWTO
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    EosSdkRpc HOWTO
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exposing-the-rpc-port" class="md-nav__link">
    <span class="md-ellipsis">
      Exposing the RPC port
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Supported modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error handling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-c-client" class="md-nav__link">
    <span class="md-ellipsis">
      Simple C++ client
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simple C++ client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#expanding-our-previous-example-creating-and-removing-one-evpn-route" class="md-nav__link">
    <span class="md-ellipsis">
      Expanding our previous example: creating and removing one EVPN route
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-issues-and-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Known Issues and Limitations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Known Issues and Limitations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eossdk-default-fields" class="md-nav__link">
    <span class="md-ellipsis">
      EosSdk default fields
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../limitations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Limitations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Security Configuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simplecppclient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple C++ client
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../api-reference/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/acl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    acl.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/acl_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    acl_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    agent.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/bgp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bgp.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/bgp_link/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bgp_link.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/bgp_path/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bgp_path.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/bgp_path_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bgp_path_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/bgp_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bgp_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/class_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    class_map.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/class_map_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    class_map_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/eapi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eapi.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/eapi_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eapi_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/eth_lag_intf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eth_lag_intf.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/eth_lag_intf_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eth_lag_intf_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/eth_phy_intf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eth_phy_intf.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/eth_phy_intf_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eth_phy_intf_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/fib_override/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fib_override.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/fib_override_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fib_override_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/intf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    intf.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/intf_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    intf_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/ip_intf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ip_intf.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/ip_intf_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ip_intf_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/ip_route/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ip_route.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/ip_route_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ip_route_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/ip_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ip_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/isis_interface/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    isis_interface.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/isis_interface_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    isis_interface_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/macsec/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    macsec.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/macsec_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    macsec_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/mpls_route/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mpls_route.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/mpls_route_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mpls_route_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/mpls_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mpls_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/mpls_vrf_label/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mpls_vrf_label.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/mpls_vrf_label_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mpls_vrf_label_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/nexthop_group/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nexthop_group.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/nexthop_group_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nexthop_group_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/policy_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    policy_map.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/policy_map_counters/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    policy_map_counters.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/policy_map_counters_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    policy_map_counters_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/policy_map_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    policy_map_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/rpc_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rpc_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api-reference/structured_filter_types/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    structured_filter_types.proto
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exposing-the-rpc-port" class="md-nav__link">
    <span class="md-ellipsis">
      Exposing the RPC port
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#supported-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Supported modules
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Error handling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#simple-c-client" class="md-nav__link">
    <span class="md-ellipsis">
      Simple C++ client
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simple C++ client">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#expanding-our-previous-example-creating-and-removing-one-evpn-route" class="md-nav__link">
    <span class="md-ellipsis">
      Expanding our previous example: creating and removing one EVPN route
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-issues-and-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Known Issues and Limitations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Known Issues and Limitations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#eossdk-default-fields" class="md-nav__link">
    <span class="md-ellipsis">
      EosSdk default fields
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="eossdkrpc-howto">EosSdkRpc HOWTO<a class="headerlink" href="#eossdkrpc-howto" title="Permanent link">¶</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h2>
<p>EosSdkRpc is an agent built on top of our EosSdk that uses gRPC as a mechanism to provide remote access to the SDK.</p>
<p>This agent is present in development versions of EOS, and is currently enabled via the "daemon" command set - starting in the 4.29 release a first-class CLI was created <code>management api eos-sdk-rpc</code> and is now the recommended configuration method. The gRPC interface that the agent supports closely matches the interface provided by EosSdk, and the intent is that the .proto interface can be publicly supported. As well as potentially allowing for remote access, using protobuf to specify the interface isolates customer code from the Linux ABI issues that come with building C++ applications on different compiler, libc, and kernel versions.</p>
<p>The default listen point for the agent is <code>localhost:9543</code> but this can be changed to allow external access. Only encrypted access is supported for EosSdkRpc agents configured via the <code>management api eos-sdk-rpc</code> CLI. An ACL should be used to limit the hosts that have access to the agent.</p>
<p>The API mirroring is intended to be modular in the same fashion as the SDK itself. Each proto file mirrors one specific SDK module and the RPC definitions and messages also aim to be as close as possible to the original SDK API call, in an attempt to make the learning gap as small as possible.</p>
<p>For performance reasons, “setter” RPC calls also come with bulk versions, which minimizes the RPC overhead. These calls differ from their original counterparts by providing a sequence of individual operations which are performed locally in batches, without requiring a round-trip to the client for each operation.</p>
<p>Multiple clients are supported by EosSdkRpc and all state is shared between these clients. Requests are fulfilled without regard to which client invoked the RPC call. Any strategy to coordinate multiple clients is out of the scope of this guide.</p>
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Permanent link">¶</a></h2>
<h4 id="releases-429-and-greater">Releases 4.29 and greater<a class="headerlink" href="#releases-429-and-greater" title="Permanent link">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is now the recommended method of configuring EosSdkRpc starting from 4.29 release.</p>
</div>
<p>The new EosSdkRpc CLI is built on top of the existing daemon CLI and allows the configuration of:</p>
<ul>
<li>Listening interface + port (default port is 9543)</li>
<li>RPC services to enable (default is none)</li>
<li>Enable/disable the server instance</li>
<li>Multiple EosSdkRpc agents</li>
</ul>
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>management api eos-sdk-rpc
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>  transport grpc &lt;insert server name&gt;
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>         local interface &lt;insert interface&gt; [ port &lt;port number&gt; ]
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>         service all
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>         no disabled
</span></code></pre></div>
<h4 id="multiple-transport-example">Multiple transport example<a class="headerlink" href="#multiple-transport-example" title="Permanent link">¶</a></h4>
<p>Configuring a different list of services for each transport. <code>foo</code> is running on the default port (9543) and <code>bar</code> is running on port 9544. Both transports have been bound to the same ip address configured for the <em>Management1</em> interface.</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>management api eos-sdk-rpc
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>  transport grpc foo
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>         local interface Management1
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>         service AgentService EapiService
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>         no disabled
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>  transport grpc bar
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>         local interface Management1 port 9544
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>         service AgentService BgpPathService
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>         no disabled
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>At present there should be no conflicts when running the same services across multiple transports, however, there may be limitations for future services - these will be documented.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A daemon agent is configured by the “management api eos-sdk-rpc” CLI. This is distinguishable from other daemon agents by the use of the transport name as the agent name and  “/usr/bin/EosSdkRpcAgent” as the executeable.</p>
</div>
<h4 id="releases-up-to-428">Releases up to 4.28<a class="headerlink" href="#releases-up-to-428" title="Permanent link">¶</a></h4>
<p>EosSdkRpc is built on top of EOS SDK and, therefore, needs to be configured the same way as any other agent compiled with EOS SDK: using the daemon configuration mode. The simplest form of configuration is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>daemon rpc
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>exec /usr/bin/EosSdkRpc
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>no shutdown
</span></code></pre></div>
<p>As mentioned earlier, the agent listens by default on localhost address so an extra argument is needed to passed on to the executable to change the listening endpoint:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>daemon rpc
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>exec /usr/bin/EosSdkRpc --listen 0.0.0.0:9543
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>no shutdown
</span></code></pre></div>
<h3 id="exposing-the-rpc-port">Exposing the RPC port<a class="headerlink" href="#exposing-the-rpc-port" title="Permanent link">¶</a></h3>
<p>Even though the agent is listening on external addresses, we still need to grant access to the agent port with an ACL. For those who have already set up a custom ACL to the control plane, a rule needs to be added: <code>permit tcp &lt;source&gt; &lt;dest&gt; eq 9543</code> (replace <code>9543</code> with your configured port).</p>
<p>To set up a custom ACL for the control plane, we start by obtaining the default ACL:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a># sh ip access-lists default-control-plane-acl
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>IP Access List default-control-plane-acl [readonly]
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>       counters per-entry
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>       10 permit icmp any any
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>       20 permit ip any any tracked [match 482 packets, 0:35:48 ago]
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>       30 permit udp any any eq bfd ttl eq 255
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>       40 permit udp any any eq bfd-echo ttl eq 254
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>       50 permit udp any any eq multihop-bfd micro-bfd sbfd
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>       60 permit udp any eq sbfd any eq sbfd-initiator
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>       70 permit ospf any any
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>       80 permit tcp any any eq ssh telnet www snmp bgp https msdp ldp netconf-ssh gnmi [match 3 packets, 0:39:06 ago]
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>       90 permit udp any any eq bootps bootpc snmp rip ntp ldp ptp-event ptp-general
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>       100 permit tcp any any eq mlag ttl eq 255
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>       110 permit udp any any eq mlag ttl eq 255
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>       120 permit vrrp any any
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>       130 permit ahp any any
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>       140 permit pim any any
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>       150 permit igmp any any
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>       160 permit tcp any any range 5900 5910
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>       170 permit tcp any any range 50000 50100
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>       180 permit udp any any range 51000 51100
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>       190 permit tcp any any eq 3333
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>       200 permit tcp any any eq nat ttl eq 255
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>       210 permit tcp any eq bgp any
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>       220 permit rsvp any any
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>       230 permit tcp any any eq 6040
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>       240 permit tcp any any eq 5541 ttl eq 255
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>       250 permit tcp any any eq 5542 ttl eq 255
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>       260 permit tcp any any eq 9559
</span></code></pre></div>
<p>The output above can be turned into a new ACL like this one. We can also add the required command to open the RPC port:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>ip access-list rpc-enabled
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>counters per-entry
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>10 permit icmp any any
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>20 permit ip any any tracked
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>30 permit udp any any eq bfd ttl eq 255
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>40 permit udp any any eq bfd-echo ttl eq 254
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>50 permit udp any any eq multihop-bfd micro-bfd sbfd
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>60 permit udp any eq sbfd any eq sbfd-initiator
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>70 permit ospf any any
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>80 permit tcp any any eq ssh telnet www snmp bgp https msdp ldp netconf-ssh gnmi
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>90 permit udp any any eq bootps bootpc snmp rip ntp ldp ptp-event ptp-general
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>100 permit tcp any any eq mlag ttl eq 255
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>110 permit udp any any eq mlag ttl eq 255
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>120 permit vrrp any any
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>130 permit ahp any any
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>140 permit pim any any
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>150 permit igmp any any
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>160 permit tcp any any range 5900 5910
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>170 permit tcp any any range 50000 50100
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>180 permit udp any any range 51000 51100
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>190 permit tcp any any eq 3333
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>200 permit tcp any any eq nat ttl eq 255
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>210 permit tcp any eq bgp any
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>220 permit rsvp any any
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>230 permit tcp any any eq 6040
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>240 permit tcp any any eq 5541 ttl eq 255
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>250 permit tcp any any eq 5542 ttl eq 255
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>260 permit tcp any any eq 9559
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>270 permit tcp any any eq 9543
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>exit
</span></code></pre></div>
<p>The new list like this one can be pasted directly into the command prompt.</p>
<p>To apply the ACL, we need to run:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>system control-plane
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>ip access-group rpc-enabled in
</span></code></pre></div>
<p>Reference: https://eos.arista.com/default-control-plane-acl-explained/</p>
<h2 id="supported-modules">Supported modules<a class="headerlink" href="#supported-modules" title="Permanent link">¶</a></h2>
<p>The proto files can be found in the directory <code>/usr/share/EosSdkRpc/proto/</code> on the EOS device. Current Supported modules are:</p>
<ul>
<li>Agent: allows a client to monitor and query option values (these are set with the option … value CLI command) or set status in the agent’s registry on SysDb. EosSdkRpc does not use any kind of record on SysDb. This space is entirely at the client’s discretion.</li>
<li>EAPI: allows a client to run CLI commands. Show commands and config commands are supported. Show commands are returned in JSON format.</li>
<li>Intf: allows a client to monitor interfaces as they are added or removed. Provides functionality to change an interface’s description or administrative status.</li>
<li>IP-intf: allow a client to monitor, query, remove or add IP addresses to interfaces.</li>
<li>IP-route: allows a client to create, delete, modify or query static routes.</li>
<li>Nexthop_group: allows client to create, delete, modify and query nexthop groups.</li>
</ul>
<p>Each module is organized in the following manner. All RPC proto files are self documented just like the original SDK header counterparts. Whenever generating code for a module, its included dependencies must be explicitly specified too. The table below that lists the required protobufs for each RPC module.</p>
<table>
<thead>
<tr>
<th>Module</th>
<th>Required protobufs</th>
</tr>
</thead>
<tbody>
<tr>
<td>acl.proto</td>
<td>acl_types.proto, intf_types.proto, ip_intf_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>agent.proto</td>
<td>rpc_types.proto</td>
</tr>
<tr>
<td>bgp.proto</td>
<td>bgp_types.proto</td>
</tr>
<tr>
<td>bgp_path.proto</td>
<td>bgp_path_types.proto, ip_types.proto</td>
</tr>
<tr>
<td>eapi.proto</td>
<td>eapi_types.proto</td>
</tr>
<tr>
<td>eth_lag_intf.proto</td>
<td>eth_lag_intf_types.proto, intf_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>eth_phy_intf.proto</td>
<td>eth_phy_intf_types.proto, intf_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>intf.proto</td>
<td>intf_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>ip_intf.proto</td>
<td>intf_types.proto, ip_intf_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>ip_route.proto</td>
<td>intf_types.proto, ip_route_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>macsec.proto</td>
<td>intf_types.proto, macsec_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>mpls_route.proto</td>
<td>acl_types.proto, intf_types.proto, ip_intf_types.proto, mpls_types.proto, mpls_route_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>mpls_vrf_label.proto</td>
<td>mpls_types.proto, mpls_vrf_label_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>nexthop_group.proto</td>
<td>nexthop_group_types.proto, intf_types.proto, mpls_types.proto, rpc_types.proto</td>
</tr>
<tr>
<td>policy_map.proto</td>
<td>acl_types.proto, intf_types.proto, ip_intf_types.proto, policy_map_types.proto, rpc_types.proto</td>
</tr>
</tbody>
</table>
<h2 id="error-handling">Error handling<a class="headerlink" href="#error-handling" title="Permanent link">¶</a></h2>
<p>The original EOS SDK communicates errors with exceptions by default. The RPC SDK has been designed to behave similarly. For functions that are not bulk calls, the SDK exceptions are translated into gRPC errors and the original error messages are also sent back to the client. gRPC’s framework may also translate these into exceptions back in the client. Here is a list of the SDK exception classes and their gRPC error counterparts:</p>
<table>
<thead>
<tr>
<th>EOS SDK exception class</th>
<th>Error code equivalent</th>
</tr>
</thead>
<tbody>
<tr>
<td>eos::invalid_range_error</td>
<td>OUT_OF_RANGE</td>
</tr>
<tr>
<td>eos::invalid_argument_error</td>
<td>INVALID_ARGUMENT</td>
</tr>
<tr>
<td>eos::configuration_error</td>
<td>FAILED_PRECONDITION</td>
</tr>
<tr>
<td>eos::unsupported_error</td>
<td>UNIMPLEMENTED</td>
</tr>
<tr>
<td>eos::error</td>
<td>INTERNAL</td>
</tr>
<tr>
<td>std::exception</td>
<td>UNKNOWN</td>
</tr>
</tbody>
</table>
<p>For the bulk RPC calls, the return structures share the same fields: one counter called processed and a structure called <code>status</code>. The works here are pretty similar to the standard C library: processed means the number of successful calls (like the return value for a call) and <code>status</code> is much like <code>errno</code>. If something went wrong, it holds the cause for the failure.</p>
<h2 id="simple-c-client">Simple C++ client<a class="headerlink" href="#simple-c-client" title="Permanent link">¶</a></h2>
<p>One key benefit of the modularized API is that the client does not need to generate every possible interface if it is just going to use one. Here is how to create a simple C++ client that uses the EAPI interface to run the command “show version”. For the purposes of this demonstration, the requirements are gRPC and Protobuf development packages plus CMake for building.</p>
<p>First thing we need to do is to obtain the current proto files. Since they are present in the router, we can just scp them:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>mkdir<span class="w"> </span>EosRpcClient
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="nb">cd</span><span class="w"> </span>EosRpcClient
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>scp<span class="w"> </span>-Cr<span class="w"> </span>root@&lt;router&gt;:/usr/share/EosSdkRpc/proto/<span class="w"> </span>.
</span></code></pre></div>
<p>This will result in a directory proto being created under our root. Now we have to compile the proto files that we are interested in. We’ll just use <code>eapi.proto</code> and <code>eapi_types.proto</code>. The first file contains messages and rpc definitions so it needs to be processed by protobuf and grpc generators. The second file only contains structures so protobuf is enough.</p>
<p>CMake has a good integration with Protobuf and already provides a convenient way to generate C++ files and headers. Unfortunately there is no official solution for gRPC yet. The file described below is a helper module to allow generation of gRPC C++ files with the same convenience as protobuf.</p>
<div class="language-cmake highlight"><span class="filename">gRPC.cmake</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="c">## A convenient gRPC proto file generator for CMake</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="nb">find_library</span><span class="p">(</span><span class="w"> </span><span class="s">grpc_LIBRARY</span><span class="w"> </span><span class="s">grpc</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nb">find_library</span><span class="p">(</span><span class="w"> </span><span class="s">grpcpp_LIBRARY</span><span class="w"> </span><span class="s">grpc++</span><span class="w"> </span><span class="s">REQUIRED</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="nb">find_program</span><span class="p">(</span><span class="w"> </span><span class="s">grpc_PROTOC_CPP</span><span class="w"> </span><span class="s">grpc_cpp_plugin</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">grpc_LIBRARIES</span><span class="w"> </span><span class="o">${</span><span class="nv">grpc_LIBRARY</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">grpcpp_LIBRARY</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="nb">function</span><span class="p">(</span><span class="w"> </span><span class="s">grpc_generate_cpp</span><span class="w"> </span><span class="s">GRPC_CC</span><span class="w"> </span><span class="s">GRPC_H</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">  </span><span class="nb">find_program</span><span class="p">(</span><span class="w"> </span><span class="s">PROTOC</span><span class="w"> </span><span class="s">protoc</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="w">  </span><span class="nb">foreach</span><span class="p">(</span><span class="s">ARG</span><span class="w"> </span><span class="s">IN</span><span class="w"> </span><span class="s">ITEMS</span><span class="w"> </span><span class="o">${</span><span class="nv">ARGN</span><span class="o">}</span><span class="p">)</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="w">     </span><span class="nb">string</span><span class="p">(</span><span class="w"> </span><span class="s">REGEX</span><span class="w"> </span><span class="s">REPLACE</span><span class="w"> </span><span class="s2">&quot;(.*/)?.*\.proto&quot;</span><span class="w"> </span><span class="s2">&quot;\\1&quot;</span><span class="w">  </span><span class="s">PROTO_DIR</span><span class="w"> </span><span class="o">${</span><span class="nv">ARG</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="w">     </span><span class="nb">string</span><span class="p">(</span><span class="w"> </span><span class="s">REPLACE</span><span class="w"> </span><span class="o">${</span><span class="nv">PROTO_DIR</span><span class="o">}</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="s">NAME</span><span class="w"> </span><span class="o">${</span><span class="nv">ARG</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a><span class="w">     </span><span class="nb">string</span><span class="p">(</span><span class="w"> </span><span class="s">REGEX</span><span class="w"> </span><span class="s">REPLACE</span><span class="w"> </span><span class="s2">&quot;(.*)\.proto&quot;</span><span class="w"> </span><span class="s2">&quot;\\1&quot;</span><span class="w">  </span><span class="s">NAME</span><span class="w"> </span><span class="o">${</span><span class="nv">NAME</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="w">     </span><span class="nb">string</span><span class="p">(</span><span class="w"> </span><span class="s">CONCAT</span><span class="w"> </span><span class="s">FULL_ARG</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_SOURCE_DIR</span><span class="o">}</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span><span class="o">${</span><span class="nv">ARG</span><span class="o">}</span><span class="p">)</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a><span class="w">     </span><span class="nb">list</span><span class="p">(</span><span class="w"> </span><span class="s">APPEND</span><span class="w"> </span><span class="s">PROTO_files</span><span class="w"> </span><span class="o">${</span><span class="nv">FULL_ARG</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a><span class="w">     </span><span class="nb">list</span><span class="p">(</span><span class="s">APPEND</span><span class="w"> </span><span class="s">CC_files</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="w">        </span><span class="s2">&quot;${CMAKE_CURRENT_BINARY_DIR}/${NAME}.grpc.pb.cc&quot;</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="w">     </span><span class="p">)</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a><span class="w">     </span><span class="nb">list</span><span class="p">(</span><span class="s">APPEND</span><span class="w"> </span><span class="s">H_files</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="w">        </span><span class="s2">&quot;${CMAKE_CURRENT_BINARY_DIR}/${NAME}.grpc.pb.h&quot;</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a><span class="w">     </span><span class="p">)</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a><span class="w">  </span><span class="nb">endforeach</span><span class="p">()</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a><span class="w">  </span><span class="nb">string</span><span class="p">(</span><span class="w"> </span><span class="s">CONCAT</span><span class="w"> </span><span class="s">PROTO_DIR</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_SOURCE_DIR</span><span class="o">}</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span><span class="o">${</span><span class="nv">PROTO_DIR</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a><span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="o">${</span><span class="nv">GRPC_CC</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">CC_files</span><span class="o">}</span><span class="w"> </span><span class="s">PARENT_SCOPE</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a><span class="w">  </span><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="o">${</span><span class="nv">GRPC_H</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">H_files</span><span class="o">}</span><span class="w"> </span><span class="s">PARENT_SCOPE</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a><span class="w">  </span><span class="nb">add_custom_command</span><span class="p">(</span><span class="w"> </span><span class="s">OUTPUT</span><span class="w"> </span><span class="o">${</span><span class="nv">CC_files</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">H_files</span><span class="o">}</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a><span class="w">     </span><span class="s">COMMAND</span><span class="w"> </span><span class="o">${</span><span class="nv">PROTOC</span><span class="o">}</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a><span class="w">        </span><span class="s">--grpc_out</span><span class="w"> </span><span class="s2">&quot;${CMAKE_CURRENT_BINARY_DIR}&quot;</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a><span class="w">        </span><span class="s">-I</span><span class="w"> </span><span class="s2">&quot;${PROTO_DIR}&quot;</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a><span class="w">        </span><span class="s">--plugin=protoc-gen-grpc=</span><span class="s2">&quot;${grpc_PROTOC_CPP}&quot;</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a><span class="w">        </span><span class="o">${</span><span class="nv">PROTO_files</span><span class="o">}</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a><span class="w">        </span><span class="s">DEPENDS</span><span class="w"> </span><span class="o">${</span><span class="nv">PROTO_files</span><span class="o">}</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a><span class="w">  </span><span class="p">)</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a><span class="nb">endfunction</span><span class="p">()</span>
</span></code></pre></div>
<p>Now we can start our own <code>CMakeLists.txt</code>:</p>
<div class="language-cmake highlight"><span class="filename">CMakeLists.txt</span><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="w"> </span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.6</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="nb">project</span><span class="p">(</span><span class="w"> </span><span class="s">eosrpcclient</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">17</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">CMAKE_EXPORT_COMPILE_COMMANDS</span><span class="w"> </span><span class="s">TRUE</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="c"># include_directories for the generated headers.</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="nb">include_directories</span><span class="p">(</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="c"># add cmake dependencies.</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="nb">find_package</span><span class="p">(</span><span class="w"> </span><span class="s">Protobuf</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="nb">include</span><span class="p">(</span><span class="w"> </span><span class="s">grpc.cmake</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="c"># this variable contains the RPC proto files</span>
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">GRPC_FILES</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">  </span><span class="s">proto/eapi.proto</span>
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="p">)</span>
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="c"># this variable contains protobuf files.</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">PROTO_FILES</span>
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">  </span><span class="s">proto/eapi_types.proto</span>
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a><span class="p">)</span>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>
</span><span id="__span-9-24"><a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a><span class="c"># generate the files</span>
</span><span id="__span-9-25"><a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a><span class="nb">protobuf_generate_cpp</span><span class="p">(</span><span class="w"> </span><span class="s">PROTO_CC</span><span class="w"> </span><span class="s">PROTO_H</span><span class="w"> </span><span class="o">${</span><span class="nv">GRPC_FILES</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">PROTO_FILES</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-9-26"><a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a><span class="nb">grpc_generate_cpp</span><span class="p">(</span><span class="w"> </span><span class="s">GRPC_CC</span><span class="w"> </span><span class="s">GRPC_H</span><span class="w"> </span><span class="o">${</span><span class="nv">GRPC_FILES</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-9-27"><a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>
</span><span id="__span-9-28"><a id="__codelineno-9-28" name="__codelineno-9-28" href="#__codelineno-9-28"></a><span class="c"># add the generated artifacts to the executable</span>
</span><span id="__span-9-29"><a id="__codelineno-9-29" name="__codelineno-9-29" href="#__codelineno-9-29"></a><span class="nb">add_executable</span><span class="p">(</span><span class="w"> </span><span class="s">eosrpcclient</span>
</span><span id="__span-9-30"><a id="__codelineno-9-30" name="__codelineno-9-30" href="#__codelineno-9-30"></a><span class="w">  </span><span class="s">client.cc</span>
</span><span id="__span-9-31"><a id="__codelineno-9-31" name="__codelineno-9-31" href="#__codelineno-9-31"></a><span class="w">  </span><span class="o">${</span><span class="nv">GRPC_CC</span><span class="o">}</span>
</span><span id="__span-9-32"><a id="__codelineno-9-32" name="__codelineno-9-32" href="#__codelineno-9-32"></a><span class="w">  </span><span class="o">${</span><span class="nv">GRPC_H</span><span class="o">}</span>
</span><span id="__span-9-33"><a id="__codelineno-9-33" name="__codelineno-9-33" href="#__codelineno-9-33"></a><span class="w">  </span><span class="o">${</span><span class="nv">PROTO_CC</span><span class="o">}</span>
</span><span id="__span-9-34"><a id="__codelineno-9-34" name="__codelineno-9-34" href="#__codelineno-9-34"></a><span class="w">  </span><span class="o">${</span><span class="nv">PROTO_H</span><span class="o">}</span>
</span><span id="__span-9-35"><a id="__codelineno-9-35" name="__codelineno-9-35" href="#__codelineno-9-35"></a><span class="p">)</span>
</span><span id="__span-9-36"><a id="__codelineno-9-36" name="__codelineno-9-36" href="#__codelineno-9-36"></a>
</span><span id="__span-9-37"><a id="__codelineno-9-37" name="__codelineno-9-37" href="#__codelineno-9-37"></a><span class="c"># set the required libraries</span>
</span><span id="__span-9-38"><a id="__codelineno-9-38" name="__codelineno-9-38" href="#__codelineno-9-38"></a><span class="nb">target_link_libraries</span><span class="p">(</span><span class="w"> </span><span class="s">eosrpcclient</span>
</span><span id="__span-9-39"><a id="__codelineno-9-39" name="__codelineno-9-39" href="#__codelineno-9-39"></a><span class="w">  </span><span class="o">${</span><span class="nv">grpc_LIBRARIES</span><span class="o">}</span>
</span><span id="__span-9-40"><a id="__codelineno-9-40" name="__codelineno-9-40" href="#__codelineno-9-40"></a><span class="w">  </span><span class="o">${</span><span class="nv">Protobuf_LIBRARIES</span><span class="o">}</span>
</span><span id="__span-9-41"><a id="__codelineno-9-41" name="__codelineno-9-41" href="#__codelineno-9-41"></a><span class="p">)</span>
</span></code></pre></div>
<p>We can now add the client code (update the address on <code>CreateChannel</code>):</p>
<div class="language-c++ highlight"><span class="filename">client.cc</span><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpc/grpc.h&gt;</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpcpp/grpcpp.h&gt;</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpcpp/client_context.h&gt;</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpcpp/create_channel.h&gt;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpcpp/security/credentials.h&gt;</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;eapi.grpc.pb.h&gt;</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;eapi.pb.h&gt;</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;eapi_types.pb.h&gt;</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">     </span><span class="c1">// set up client side API</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">     </span><span class="k">auto</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="p">{</span><span class="n">grpc</span><span class="o">::</span><span class="n">CreateChannel</span><span class="p">(</span><span class="s">&quot;&lt;router-addr&gt;:9543&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">grpc</span><span class="o">::</span><span class="n">InsecureChannelCredentials</span><span class="p">())};</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">     </span><span class="k">auto</span><span class="w"> </span><span class="n">eapi</span><span class="w"> </span><span class="p">{</span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">EapiMgrService</span><span class="o">::</span><span class="n">Stub</span><span class="p">(</span><span class="n">channel</span><span class="p">)};</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">     </span><span class="c1">// prepare for the RPC call.</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">     </span><span class="c1">// context allows us to set up metadata, compression or authentication on a per-call basis.</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">     </span><span class="c1">// see https://grpc.github.io/grpc/cpp/classgrpc_1_1_client_context.html</span>
</span><span id="__span-10-22"><a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">     </span><span class="n">grpc</span><span class="o">::</span><span class="n">ClientContext</span><span class="w"> </span><span class="n">context</span><span class="p">;</span>
</span><span id="__span-10-23"><a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">     </span><span class="c1">// generated request and response objects</span>
</span><span id="__span-10-24"><a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">     </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">RunShowCmdRequest</span><span class="w"> </span><span class="n">request</span><span class="p">;</span>
</span><span id="__span-10-25"><a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">     </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">RunShowCmdResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
</span><span id="__span-10-26"><a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="w">     </span><span class="n">request</span><span class="p">.</span><span class="n">set_command</span><span class="p">(</span><span class="s">&quot;show version&quot;</span><span class="p">);</span>
</span><span id="__span-10-27"><a id="__codelineno-10-27" name="__codelineno-10-27" href="#__codelineno-10-27"></a>
</span><span id="__span-10-28"><a id="__codelineno-10-28" name="__codelineno-10-28" href="#__codelineno-10-28"></a><span class="w">     </span><span class="c1">// make the call.</span>
</span><span id="__span-10-29"><a id="__codelineno-10-29" name="__codelineno-10-29" href="#__codelineno-10-29"></a><span class="w">     </span><span class="n">eapi</span><span class="p">.</span><span class="n">run_show_cmd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">response</span><span class="p">);</span>
</span><span id="__span-10-30"><a id="__codelineno-10-30" name="__codelineno-10-30" href="#__codelineno-10-30"></a><span class="w">     </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">eapiResponse</span><span class="w"> </span><span class="p">{</span><span class="n">response</span><span class="p">.</span><span class="n">response</span><span class="p">()};</span>
</span><span id="__span-10-31"><a id="__codelineno-10-31" name="__codelineno-10-31" href="#__codelineno-10-31"></a>
</span><span id="__span-10-32"><a id="__codelineno-10-32" name="__codelineno-10-32" href="#__codelineno-10-32"></a><span class="w">     </span><span class="c1">// This particular check is part of the eAPI module</span>
</span><span id="__span-10-33"><a id="__codelineno-10-33" name="__codelineno-10-33" href="#__codelineno-10-33"></a><span class="w">     </span><span class="c1">// see http://aristanetworks.github.io/EosSdk/docs/2.2.0/ref/eapi.html</span>
</span><span id="__span-10-34"><a id="__codelineno-10-34" name="__codelineno-10-34" href="#__codelineno-10-34"></a><span class="w">     </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">eapiResponse</span><span class="p">.</span><span class="n">success</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-35"><a id="__codelineno-10-35" name="__codelineno-10-35" href="#__codelineno-10-35"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">logic_error</span><span class="p">(</span><span class="w"> </span><span class="n">eapiResponse</span><span class="p">.</span><span class="n">error_message</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
</span><span id="__span-10-36"><a id="__codelineno-10-36" name="__codelineno-10-36" href="#__codelineno-10-36"></a><span class="w">     </span><span class="p">}</span>
</span><span id="__span-10-37"><a id="__codelineno-10-37" name="__codelineno-10-37" href="#__codelineno-10-37"></a>
</span><span id="__span-10-38"><a id="__codelineno-10-38" name="__codelineno-10-38" href="#__codelineno-10-38"></a><span class="w">     </span><span class="c1">// For a successful show command, responses[0] holds the output as JSON.</span>
</span><span id="__span-10-39"><a id="__codelineno-10-39" name="__codelineno-10-39" href="#__codelineno-10-39"></a><span class="w">     </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Response to </span><span class="se">\&quot;</span><span class="s">show version</span><span class="se">\&quot;</span><span class="s">: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">eapiResponse</span><span class="p">.</span><span class="n">responses</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span><span id="__span-10-40"><a id="__codelineno-10-40" name="__codelineno-10-40" href="#__codelineno-10-40"></a>
</span><span id="__span-10-41"><a id="__codelineno-10-41" name="__codelineno-10-41" href="#__codelineno-10-41"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-42"><a id="__codelineno-10-42" name="__codelineno-10-42" href="#__codelineno-10-42"></a><span class="w">     </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;call failed: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span><span id="__span-10-43"><a id="__codelineno-10-43" name="__codelineno-10-43" href="#__codelineno-10-43"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-44"><a id="__codelineno-10-44" name="__codelineno-10-44" href="#__codelineno-10-44"></a><span class="p">}</span>
</span></code></pre></div>
<p>With this, we can build and test the project:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>mkdir<span class="w"> </span>build
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="nb">cd</span><span class="w"> </span>build
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>cmake<span class="w"> </span>..<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>make
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>./eosrpcclient
</span></code></pre></div>
<p>And the expected response is something like this:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>Response to &quot;show version&quot;: {&quot;imageFormatVersion&quot;: &quot;1.0&quot;, &quot;uptime&quot;: 1506.9400000000001, &quot;modelName&quot;: &quot;DCS-7050QX-32-F&quot;, &quot;internalVersion&quot;: &quot;4.27.0F-2GB-24596680.eostrunk&quot;, &quot;memTotal&quot;: 4002848, &quot;mfgName&quot;: &quot;Arista&quot;, &quot;serialNumber&quot;: &quot;JAS12430029&quot;, &quot;systemMacAddress&quot;: &quot;00:1c:73:00:da:78&quot;, &quot;bootupTimestamp&quot;: 1634646046.0, &quot;memFree&quot;: 2128936, &quot;version&quot;: &quot;4.27.0F-2GB-24596680.eostrunk (engineering build)&quot;, &quot;configMacAddress&quot;: &quot;00:00:00:00:00:00&quot;, &quot;isIntlVersion&quot;: false, &quot;internalBuildId&quot;: &quot;7d37543b-18ae-47f7-afe6-a2d4afc6b9ab&quot;, &quot;hardwareRevision&quot;: &quot;00.00&quot;, &quot;hwMacAddress&quot;: &quot;00:1c:73:00:da:78&quot;, &quot;architecture&quot;: &quot;x86_64&quot;}
</span></code></pre></div>
<h3 id="expanding-our-previous-example-creating-and-removing-one-evpn-route">Expanding our previous example: creating and removing one EVPN route<a class="headerlink" href="#expanding-our-previous-example-creating-and-removing-one-evpn-route" title="Permanent link">¶</a></h3>
<p>Now, let's expand our example to use the SDK (ip_route) to add and remove a single static route. The example below builds on top of the previous.</p>
<div class="language-cmake highlight"><span class="filename">CMakeLists.txt</span><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="w"> </span><span class="s">VERSION</span><span class="w"> </span><span class="s">3.6</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="nb">project</span><span class="p">(</span><span class="w"> </span><span class="s">eosrpcclient</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">CMAKE_CXX_STANDARD</span><span class="w"> </span><span class="s">17</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">CMAKE_EXPORT_COMPILE_COMMANDS</span><span class="w"> </span><span class="s">TRUE</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="c"># include_directories for the generated headers.</span>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="nb">include_directories</span><span class="p">(</span><span class="w"> </span><span class="o">${</span><span class="nv">CMAKE_CURRENT_BINARY_DIR</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="c"># add cmake dependencies.</span>
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="nb">find_package</span><span class="p">(</span><span class="w"> </span><span class="s">Protobuf</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="hll"><span class="nb">find_package</span><span class="p">(</span><span class="w"> </span><span class="s">fmt</span><span class="w"> </span><span class="p">)</span>
</span></span><span id="__span-13-13"><a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="nb">include</span><span class="p">(</span><span class="w"> </span><span class="s">grpc.cmake</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-14"><a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>
</span><span id="__span-13-15"><a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="c"># this variable contains the RPC proto files</span>
</span><span id="__span-13-16"><a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">GRPC_FILES</span>
</span><span id="__span-13-17"><a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a><span class="w">  </span><span class="s">proto/eapi.proto</span>
</span><span id="__span-13-18"><a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="hll"><span class="w">  </span><span class="s">proto/ip_route.proto</span>
</span></span><span id="__span-13-19"><a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="p">)</span>
</span><span id="__span-13-20"><a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>
</span><span id="__span-13-21"><a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="c"># this variable is set to the list of protobuf only files.</span>
</span><span id="__span-13-22"><a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="nb">set</span><span class="p">(</span><span class="w"> </span><span class="s">PROTO_FILES</span>
</span><span id="__span-13-23"><a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="w">  </span><span class="s">proto/eapi_types.proto</span>
</span><span id="__span-13-24"><a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a><span class="hll"><span class="w">  </span><span class="s">proto/intf_types.proto</span>
</span></span><span id="__span-13-25"><a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="hll"><span class="w">  </span><span class="s">proto/ip_route_types.proto</span>
</span></span><span id="__span-13-26"><a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="hll"><span class="w">  </span><span class="s">proto/ip_types.proto</span>
</span></span><span id="__span-13-27"><a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a><span class="hll"><span class="w">  </span><span class="s">proto/rpc_types.proto</span>
</span></span><span id="__span-13-28"><a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="p">)</span>
</span><span id="__span-13-29"><a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a>
</span><span id="__span-13-30"><a id="__codelineno-13-30" name="__codelineno-13-30" href="#__codelineno-13-30"></a><span class="c"># generate the files</span>
</span><span id="__span-13-31"><a id="__codelineno-13-31" name="__codelineno-13-31" href="#__codelineno-13-31"></a><span class="nb">protobuf_generate_cpp</span><span class="p">(</span><span class="w"> </span><span class="s">PROTO_CC</span><span class="w"> </span><span class="s">PROTO_H</span><span class="w"> </span><span class="o">${</span><span class="nv">GRPC_FILES</span><span class="o">}</span><span class="w"> </span><span class="o">${</span><span class="nv">PROTO_FILES</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-32"><a id="__codelineno-13-32" name="__codelineno-13-32" href="#__codelineno-13-32"></a><span class="nb">grpc_generate_cpp</span><span class="p">(</span><span class="w"> </span><span class="s">GRPC_CC</span><span class="w"> </span><span class="s">GRPC_H</span><span class="w"> </span><span class="o">${</span><span class="nv">GRPC_FILES</span><span class="o">}</span><span class="w"> </span><span class="p">)</span>
</span><span id="__span-13-33"><a id="__codelineno-13-33" name="__codelineno-13-33" href="#__codelineno-13-33"></a>
</span><span id="__span-13-34"><a id="__codelineno-13-34" name="__codelineno-13-34" href="#__codelineno-13-34"></a><span class="c"># add the generated artifacts to the executable</span>
</span><span id="__span-13-35"><a id="__codelineno-13-35" name="__codelineno-13-35" href="#__codelineno-13-35"></a><span class="nb">add_executable</span><span class="p">(</span><span class="w"> </span><span class="s">eosrpcclient</span>
</span><span id="__span-13-36"><a id="__codelineno-13-36" name="__codelineno-13-36" href="#__codelineno-13-36"></a><span class="w">  </span><span class="s">client.cc</span>
</span><span id="__span-13-37"><a id="__codelineno-13-37" name="__codelineno-13-37" href="#__codelineno-13-37"></a><span class="w">  </span><span class="o">${</span><span class="nv">GRPC_CC</span><span class="o">}</span>
</span><span id="__span-13-38"><a id="__codelineno-13-38" name="__codelineno-13-38" href="#__codelineno-13-38"></a><span class="w">  </span><span class="o">${</span><span class="nv">GRPC_H</span><span class="o">}</span>
</span><span id="__span-13-39"><a id="__codelineno-13-39" name="__codelineno-13-39" href="#__codelineno-13-39"></a><span class="w">  </span><span class="o">${</span><span class="nv">PROTO_CC</span><span class="o">}</span>
</span><span id="__span-13-40"><a id="__codelineno-13-40" name="__codelineno-13-40" href="#__codelineno-13-40"></a><span class="w">  </span><span class="o">${</span><span class="nv">PROTO_H</span><span class="o">}</span>
</span><span id="__span-13-41"><a id="__codelineno-13-41" name="__codelineno-13-41" href="#__codelineno-13-41"></a><span class="p">)</span>
</span><span id="__span-13-42"><a id="__codelineno-13-42" name="__codelineno-13-42" href="#__codelineno-13-42"></a>
</span><span id="__span-13-43"><a id="__codelineno-13-43" name="__codelineno-13-43" href="#__codelineno-13-43"></a><span class="c"># set the required libraries</span>
</span><span id="__span-13-44"><a id="__codelineno-13-44" name="__codelineno-13-44" href="#__codelineno-13-44"></a><span class="nb">target_link_libraries</span><span class="p">(</span><span class="w"> </span><span class="s">eosrpcclient</span>
</span><span id="__span-13-45"><a id="__codelineno-13-45" name="__codelineno-13-45" href="#__codelineno-13-45"></a><span class="w">  </span><span class="o">${</span><span class="nv">grpc_LIBRARIES</span><span class="o">}</span>
</span><span id="__span-13-46"><a id="__codelineno-13-46" name="__codelineno-13-46" href="#__codelineno-13-46"></a><span class="w">  </span><span class="o">${</span><span class="nv">Protobuf_LIBRARIES</span><span class="o">}</span>
</span><span id="__span-13-47"><a id="__codelineno-13-47" name="__codelineno-13-47" href="#__codelineno-13-47"></a><span class="hll"><span class="w">  </span><span class="s">fmt::fmt</span>
</span></span><span id="__span-13-48"><a id="__codelineno-13-48" name="__codelineno-13-48" href="#__codelineno-13-48"></a><span class="p">)</span>
</span></code></pre></div>
<p>And the updated code, with some added functions:</p>
<div class="language-c++ highlight"><span class="filename">client.cc</span><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpc/grpc.h&gt;</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpcpp/grpcpp.h&gt;</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpcpp/client_context.h&gt;</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpcpp/create_channel.h&gt;</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;grpcpp/security/credentials.h&gt;</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;eapi.grpc.pb.h&gt;</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;eapi.pb.h&gt;</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;eapi_types.pb.h&gt;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ip_route.grpc.pb.h&gt;</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;ip_route_types.pb.h&gt;</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;iostream&gt;</span>
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;fmt/format.h&gt;</span>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">intfName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&lt;interface&gt;&quot;</span><span class="p">;</span>
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&lt;router-addr&gt;:9543&quot;</span><span class="p">;</span>
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteKey</span><span class="w"> </span><span class="nf">sampleRouteKey</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteKey</span><span class="w"> </span><span class="n">rk</span><span class="p">;</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">rk</span><span class="p">.</span><span class="n">mutable_prefix</span><span class="p">();</span>
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a><span class="w">  </span><span class="c1">// IP addresses are specified as binary strings. In the example: 100.0.0.0/8</span>
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a><span class="w">  </span><span class="n">prefix</span><span class="p">.</span><span class="n">set_ip_addr</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\x64\0\0\0</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a><span class="w">  </span><span class="n">prefix</span><span class="p">.</span><span class="n">set_length</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span>
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">rk</span><span class="p">;</span>
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a><span class="p">}</span>
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a><span class="c1">// sets an example EVPN via for a route.</span>
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteVia</span><span class="w"> </span><span class="nf">sampleRouteVia</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteVia</span><span class="w"> </span><span class="n">via</span><span class="p">;</span>
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a><span class="w">  </span><span class="o">*</span><span class="n">via</span><span class="p">.</span><span class="n">mutable_key</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sampleRouteKey</span><span class="p">();</span>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a><span class="w">  </span><span class="n">via</span><span class="p">.</span><span class="n">set_vni</span><span class="p">(</span><span class="mi">99</span><span class="p">);</span>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a><span class="w">  </span><span class="c1">// VTEP address 1.0.2.1</span>
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a><span class="w">  </span><span class="n">via</span><span class="p">.</span><span class="n">set_vtep_addr</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\x01\0\x02\x01</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a><span class="w">  </span><span class="c1">// virtual mac 00:aa:00:aa:00:bb</span>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a><span class="w">  </span><span class="n">via</span><span class="p">.</span><span class="n">set_router_mac_eth_addr</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\0\xaa\0\xaa\0\xbb</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">);</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a><span class="w">  </span><span class="n">via</span><span class="p">.</span><span class="n">mutable_intf_id</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">set_name</span><span class="p">(</span><span class="n">intfName</span><span class="p">);</span>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">via</span><span class="p">;</span>
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a><span class="p">}</span>
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a>
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a><span class="kt">bool</span><span class="w"> </span><span class="nf">routeExists</span><span class="p">(</span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteMgrService</span><span class="o">::</span><span class="n">Stub</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ipRouteClient</span><span class="p">,</span>
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a><span class="w">                </span><span class="k">const</span><span class="w"> </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteKey</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">key</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-44"><a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ip_route_exists</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-14-45"><a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteExistsRequest</span><span class="w"> </span><span class="n">existsRequest</span><span class="p">;</span>
</span><span id="__span-14-46"><a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteExistsResponse</span><span class="w"> </span><span class="n">existsResponse</span><span class="p">;</span>
</span><span id="__span-14-47"><a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a><span class="w">  </span><span class="n">grpc</span><span class="o">::</span><span class="n">ClientContext</span><span class="w"> </span><span class="n">existsContext</span><span class="p">;</span>
</span><span id="__span-14-48"><a id="__codelineno-14-48" name="__codelineno-14-48" href="#__codelineno-14-48"></a><span class="w">  </span><span class="o">*</span><span class="n">existsRequest</span><span class="p">.</span><span class="n">mutable_key</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">;</span>
</span><span id="__span-14-49"><a id="__codelineno-14-49" name="__codelineno-14-49" href="#__codelineno-14-49"></a><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ipRouteClient</span><span class="p">.</span><span class="n">ip_route_exists</span><span class="p">(</span><span class="o">&amp;</span><span class="n">existsContext</span><span class="p">,</span><span class="w"> </span><span class="n">existsRequest</span><span class="p">,</span>
</span><span id="__span-14-50"><a id="__codelineno-14-50" name="__codelineno-14-50" href="#__codelineno-14-50"></a><span class="w">     </span><span class="o">&amp;</span><span class="n">existsResponse</span><span class="p">);</span>
</span><span id="__span-14-51"><a id="__codelineno-14-51" name="__codelineno-14-51" href="#__codelineno-14-51"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-52"><a id="__codelineno-14-52" name="__codelineno-14-52" href="#__codelineno-14-52"></a><span class="w">     </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">error_message</span><span class="p">());</span>
</span><span id="__span-14-53"><a id="__codelineno-14-53" name="__codelineno-14-53" href="#__codelineno-14-53"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-54"><a id="__codelineno-14-54" name="__codelineno-14-54" href="#__codelineno-14-54"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">existsResponse</span><span class="p">.</span><span class="n">exists</span><span class="p">();</span>
</span><span id="__span-14-55"><a id="__codelineno-14-55" name="__codelineno-14-55" href="#__codelineno-14-55"></a><span class="p">}</span>
</span><span id="__span-14-56"><a id="__codelineno-14-56" name="__codelineno-14-56" href="#__codelineno-14-56"></a>
</span><span id="__span-14-57"><a id="__codelineno-14-57" name="__codelineno-14-57" href="#__codelineno-14-57"></a><span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span><span class="w"> </span><span class="k">operator</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">os</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRoute</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-58"><a id="__codelineno-14-58" name="__codelineno-14-58" href="#__codelineno-14-58"></a><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">route</span><span class="p">.</span><span class="n">key</span><span class="p">();</span>
</span><span id="__span-14-59"><a id="__codelineno-14-59" name="__codelineno-14-59" href="#__codelineno-14-59"></a><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">pfx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">key</span><span class="p">.</span><span class="n">prefix</span><span class="p">();</span>
</span><span id="__span-14-60"><a id="__codelineno-14-60" name="__codelineno-14-60" href="#__codelineno-14-60"></a><span class="w">  </span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pfxaddr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="k">const</span><span class="w"> </span><span class="n">u_char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">pfx</span><span class="p">.</span><span class="n">ip_addr</span><span class="p">().</span><span class="n">data</span><span class="p">());</span>
</span><span id="__span-14-61"><a id="__codelineno-14-61" name="__codelineno-14-61" href="#__codelineno-14-61"></a><span class="w">  </span><span class="n">os</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">fmt</span><span class="o">::</span><span class="n">format</span><span class="p">(</span><span class="w"> </span><span class="s">&quot;key:(pfx={}.{}.{}.{}/{},pref={}), tag={}&quot;</span><span class="p">,</span>
</span><span id="__span-14-62"><a id="__codelineno-14-62" name="__codelineno-14-62" href="#__codelineno-14-62"></a><span class="w">     </span><span class="n">pfxaddr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">pfxaddr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">pfxaddr</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="n">pfxaddr</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="n">pfx</span><span class="p">.</span><span class="n">length</span><span class="p">(),</span><span class="w"> </span><span class="n">key</span><span class="p">.</span><span class="n">preference</span><span class="p">(),</span>
</span><span id="__span-14-63"><a id="__codelineno-14-63" name="__codelineno-14-63" href="#__codelineno-14-63"></a><span class="w">     </span><span class="n">route</span><span class="p">.</span><span class="n">tag</span><span class="p">());</span>
</span><span id="__span-14-64"><a id="__codelineno-14-64" name="__codelineno-14-64" href="#__codelineno-14-64"></a><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">os</span><span class="p">;</span>
</span><span id="__span-14-65"><a id="__codelineno-14-65" name="__codelineno-14-65" href="#__codelineno-14-65"></a><span class="p">}</span>
</span><span id="__span-14-66"><a id="__codelineno-14-66" name="__codelineno-14-66" href="#__codelineno-14-66"></a>
</span><span id="__span-14-67"><a id="__codelineno-14-67" name="__codelineno-14-67" href="#__codelineno-14-67"></a><span class="c1">/// this function lists all configured routes to stdout</span>
</span><span id="__span-14-68"><a id="__codelineno-14-68" name="__codelineno-14-68" href="#__codelineno-14-68"></a><span class="kt">void</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteMgrService</span><span class="o">::</span><span class="n">Stub</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ipRouteClient</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-69"><a id="__codelineno-14-69" name="__codelineno-14-69" href="#__codelineno-14-69"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRoutesRequest</span><span class="w"> </span><span class="n">request</span><span class="p">;</span>
</span><span id="__span-14-70"><a id="__codelineno-14-70" name="__codelineno-14-70" href="#__codelineno-14-70"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRoutesResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
</span><span id="__span-14-71"><a id="__codelineno-14-71" name="__codelineno-14-71" href="#__codelineno-14-71"></a><span class="w">  </span><span class="n">grpc</span><span class="o">::</span><span class="n">ClientContext</span><span class="w"> </span><span class="n">context</span><span class="p">;</span>
</span><span id="__span-14-72"><a id="__codelineno-14-72" name="__codelineno-14-72" href="#__codelineno-14-72"></a><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">responseReader</span><span class="p">(</span><span class="n">ipRouteClient</span><span class="p">.</span><span class="n">ip_routes</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">));</span>
</span><span id="__span-14-73"><a id="__codelineno-14-73" name="__codelineno-14-73" href="#__codelineno-14-73"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;routes:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-14-74"><a id="__codelineno-14-74" name="__codelineno-14-74" href="#__codelineno-14-74"></a><span class="w">  </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">responseReader</span><span class="o">-&gt;</span><span class="n">Read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">response</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-75"><a id="__codelineno-14-75" name="__codelineno-14-75" href="#__codelineno-14-75"></a><span class="w">     </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\t&#39;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="n">response</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span><span id="__span-14-76"><a id="__codelineno-14-76" name="__codelineno-14-76" href="#__codelineno-14-76"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-77"><a id="__codelineno-14-77" name="__codelineno-14-77" href="#__codelineno-14-77"></a><span class="p">}</span>
</span><span id="__span-14-78"><a id="__codelineno-14-78" name="__codelineno-14-78" href="#__codelineno-14-78"></a>
</span><span id="__span-14-79"><a id="__codelineno-14-79" name="__codelineno-14-79" href="#__codelineno-14-79"></a><span class="c1">/// This function creates a single EVPN route for prefix 100.0.0.0/8 to vtep 1.0.2.1</span>
</span><span id="__span-14-80"><a id="__codelineno-14-80" name="__codelineno-14-80" href="#__codelineno-14-80"></a><span class="kt">void</span><span class="w"> </span><span class="n">createEvpnRoute</span><span class="p">(</span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteMgrService</span><span class="o">::</span><span class="n">Stub</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ipRouteClient</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-81"><a id="__codelineno-14-81" name="__codelineno-14-81" href="#__codelineno-14-81"></a><span class="w">  </span><span class="c1">// create route</span>
</span><span id="__span-14-82"><a id="__codelineno-14-82" name="__codelineno-14-82" href="#__codelineno-14-82"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ip_route_set</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-14-83"><a id="__codelineno-14-83" name="__codelineno-14-83" href="#__codelineno-14-83"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteSetRequest</span><span class="w"> </span><span class="n">request</span><span class="p">;</span>
</span><span id="__span-14-84"><a id="__codelineno-14-84" name="__codelineno-14-84" href="#__codelineno-14-84"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteSetResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
</span><span id="__span-14-85"><a id="__codelineno-14-85" name="__codelineno-14-85" href="#__codelineno-14-85"></a><span class="w">  </span><span class="n">grpc</span><span class="o">::</span><span class="n">ClientContext</span><span class="w"> </span><span class="n">context</span><span class="p">;</span>
</span><span id="__span-14-86"><a id="__codelineno-14-86" name="__codelineno-14-86" href="#__codelineno-14-86"></a><span class="w">  </span><span class="n">request</span><span class="p">.</span><span class="n">set_action</span><span class="p">(</span><span class="o">::</span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteActions</span><span class="o">::</span><span class="n">IP_ROUTE_ACTION_FORWARD</span><span class="p">);</span>
</span><span id="__span-14-87"><a id="__codelineno-14-87" name="__codelineno-14-87" href="#__codelineno-14-87"></a><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">route</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="n">request</span><span class="p">.</span><span class="n">mutable_route</span><span class="p">();</span>
</span><span id="__span-14-88"><a id="__codelineno-14-88" name="__codelineno-14-88" href="#__codelineno-14-88"></a><span class="w">  </span><span class="o">*</span><span class="n">route</span><span class="p">.</span><span class="n">mutable_key</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sampleRouteKey</span><span class="p">();</span>
</span><span id="__span-14-89"><a id="__codelineno-14-89" name="__codelineno-14-89" href="#__codelineno-14-89"></a><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ipRouteClient</span><span class="p">.</span><span class="n">ip_route_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">response</span><span class="p">);</span>
</span><span id="__span-14-90"><a id="__codelineno-14-90" name="__codelineno-14-90" href="#__codelineno-14-90"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-91"><a id="__codelineno-14-91" name="__codelineno-14-91" href="#__codelineno-14-91"></a><span class="w">     </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">error_message</span><span class="p">());</span>
</span><span id="__span-14-92"><a id="__codelineno-14-92" name="__codelineno-14-92" href="#__codelineno-14-92"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-93"><a id="__codelineno-14-93" name="__codelineno-14-93" href="#__codelineno-14-93"></a>
</span><span id="__span-14-94"><a id="__codelineno-14-94" name="__codelineno-14-94" href="#__codelineno-14-94"></a><span class="w">  </span><span class="c1">// set via for route</span>
</span><span id="__span-14-95"><a id="__codelineno-14-95" name="__codelineno-14-95" href="#__codelineno-14-95"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ip_route_via_set</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-14-96"><a id="__codelineno-14-96" name="__codelineno-14-96" href="#__codelineno-14-96"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteViaSetRequest</span><span class="w"> </span><span class="n">viaRequest</span><span class="p">;</span>
</span><span id="__span-14-97"><a id="__codelineno-14-97" name="__codelineno-14-97" href="#__codelineno-14-97"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteViaSetResponse</span><span class="w"> </span><span class="n">viaResponse</span><span class="p">;</span>
</span><span id="__span-14-98"><a id="__codelineno-14-98" name="__codelineno-14-98" href="#__codelineno-14-98"></a><span class="w">  </span><span class="n">grpc</span><span class="o">::</span><span class="n">ClientContext</span><span class="w"> </span><span class="n">viaContext</span><span class="p">;</span>
</span><span id="__span-14-99"><a id="__codelineno-14-99" name="__codelineno-14-99" href="#__codelineno-14-99"></a><span class="w">  </span><span class="o">*</span><span class="n">viaRequest</span><span class="p">.</span><span class="n">mutable_via</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sampleRouteVia</span><span class="p">();</span>
</span><span id="__span-14-100"><a id="__codelineno-14-100" name="__codelineno-14-100" href="#__codelineno-14-100"></a><span class="w">  </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ipRouteClient</span><span class="p">.</span><span class="n">ip_route_via_set</span><span class="p">(</span><span class="o">&amp;</span><span class="n">viaContext</span><span class="p">,</span><span class="w"> </span><span class="n">viaRequest</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">viaResponse</span><span class="p">);</span>
</span><span id="__span-14-101"><a id="__codelineno-14-101" name="__codelineno-14-101" href="#__codelineno-14-101"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-102"><a id="__codelineno-14-102" name="__codelineno-14-102" href="#__codelineno-14-102"></a><span class="w">     </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">error_message</span><span class="p">());</span>
</span><span id="__span-14-103"><a id="__codelineno-14-103" name="__codelineno-14-103" href="#__codelineno-14-103"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-104"><a id="__codelineno-14-104" name="__codelineno-14-104" href="#__codelineno-14-104"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">routeExists</span><span class="p">(</span><span class="n">ipRouteClient</span><span class="p">,</span><span class="w"> </span><span class="n">route</span><span class="p">.</span><span class="n">key</span><span class="p">()</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-105"><a id="__codelineno-14-105" name="__codelineno-14-105" href="#__codelineno-14-105"></a><span class="w">     </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;ip_route_exists - not found&quot;</span><span class="p">);</span>
</span><span id="__span-14-106"><a id="__codelineno-14-106" name="__codelineno-14-106" href="#__codelineno-14-106"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-107"><a id="__codelineno-14-107" name="__codelineno-14-107" href="#__codelineno-14-107"></a><span class="p">}</span>
</span><span id="__span-14-108"><a id="__codelineno-14-108" name="__codelineno-14-108" href="#__codelineno-14-108"></a>
</span><span id="__span-14-109"><a id="__codelineno-14-109" name="__codelineno-14-109" href="#__codelineno-14-109"></a><span class="c1">// This function deletes the via and the route created by the previous function.</span>
</span><span id="__span-14-110"><a id="__codelineno-14-110" name="__codelineno-14-110" href="#__codelineno-14-110"></a><span class="kt">void</span><span class="w"> </span><span class="n">removeEvpnRoute</span><span class="p">(</span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteMgrService</span><span class="o">::</span><span class="n">Stub</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">ipRouteClient</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-111"><a id="__codelineno-14-111" name="__codelineno-14-111" href="#__codelineno-14-111"></a><span class="w">  </span><span class="c1">// deletes a via for our test route.</span>
</span><span id="__span-14-112"><a id="__codelineno-14-112" name="__codelineno-14-112" href="#__codelineno-14-112"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ip_route_via_del</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-14-113"><a id="__codelineno-14-113" name="__codelineno-14-113" href="#__codelineno-14-113"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteViaDelRequest</span><span class="w"> </span><span class="n">viaRequest</span><span class="p">;</span>
</span><span id="__span-14-114"><a id="__codelineno-14-114" name="__codelineno-14-114" href="#__codelineno-14-114"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteViaDelResponse</span><span class="w"> </span><span class="n">viaResponse</span><span class="p">;</span>
</span><span id="__span-14-115"><a id="__codelineno-14-115" name="__codelineno-14-115" href="#__codelineno-14-115"></a><span class="w">  </span><span class="n">grpc</span><span class="o">::</span><span class="n">ClientContext</span><span class="w"> </span><span class="n">viaContext</span><span class="p">;</span>
</span><span id="__span-14-116"><a id="__codelineno-14-116" name="__codelineno-14-116" href="#__codelineno-14-116"></a><span class="w">  </span><span class="o">*</span><span class="n">viaRequest</span><span class="p">.</span><span class="n">mutable_via</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sampleRouteVia</span><span class="p">();</span>
</span><span id="__span-14-117"><a id="__codelineno-14-117" name="__codelineno-14-117" href="#__codelineno-14-117"></a><span class="w">  </span><span class="k">auto</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ipRouteClient</span><span class="p">.</span><span class="n">ip_route_via_del</span><span class="p">(</span><span class="o">&amp;</span><span class="n">viaContext</span><span class="p">,</span><span class="w"> </span><span class="n">viaRequest</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">viaResponse</span><span class="p">);</span>
</span><span id="__span-14-118"><a id="__codelineno-14-118" name="__codelineno-14-118" href="#__codelineno-14-118"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-119"><a id="__codelineno-14-119" name="__codelineno-14-119" href="#__codelineno-14-119"></a><span class="w">     </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">error_message</span><span class="p">());</span>
</span><span id="__span-14-120"><a id="__codelineno-14-120" name="__codelineno-14-120" href="#__codelineno-14-120"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-121"><a id="__codelineno-14-121" name="__codelineno-14-121" href="#__codelineno-14-121"></a>
</span><span id="__span-14-122"><a id="__codelineno-14-122" name="__codelineno-14-122" href="#__codelineno-14-122"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;ip_route_del</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
</span><span id="__span-14-123"><a id="__codelineno-14-123" name="__codelineno-14-123" href="#__codelineno-14-123"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteDelRequest</span><span class="w"> </span><span class="n">request</span><span class="p">;</span>
</span><span id="__span-14-124"><a id="__codelineno-14-124" name="__codelineno-14-124" href="#__codelineno-14-124"></a><span class="w">  </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteDelResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
</span><span id="__span-14-125"><a id="__codelineno-14-125" name="__codelineno-14-125" href="#__codelineno-14-125"></a><span class="w">  </span><span class="n">grpc</span><span class="o">::</span><span class="n">ClientContext</span><span class="w"> </span><span class="n">context</span><span class="p">;</span>
</span><span id="__span-14-126"><a id="__codelineno-14-126" name="__codelineno-14-126" href="#__codelineno-14-126"></a><span class="w">  </span><span class="o">*</span><span class="n">request</span><span class="p">.</span><span class="n">mutable_key</span><span class="p">()</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sampleRouteKey</span><span class="p">();</span>
</span><span id="__span-14-127"><a id="__codelineno-14-127" name="__codelineno-14-127" href="#__codelineno-14-127"></a><span class="w">  </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ipRouteClient</span><span class="p">.</span><span class="n">ip_route_del</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">response</span><span class="p">);</span>
</span><span id="__span-14-128"><a id="__codelineno-14-128" name="__codelineno-14-128" href="#__codelineno-14-128"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">status</span><span class="p">.</span><span class="n">ok</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-129"><a id="__codelineno-14-129" name="__codelineno-14-129" href="#__codelineno-14-129"></a><span class="w">     </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="n">error_message</span><span class="p">());</span>
</span><span id="__span-14-130"><a id="__codelineno-14-130" name="__codelineno-14-130" href="#__codelineno-14-130"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-131"><a id="__codelineno-14-131" name="__codelineno-14-131" href="#__codelineno-14-131"></a>
</span><span id="__span-14-132"><a id="__codelineno-14-132" name="__codelineno-14-132" href="#__codelineno-14-132"></a><span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;!&#39;</span><span class="p">;</span>
</span><span id="__span-14-133"><a id="__codelineno-14-133" name="__codelineno-14-133" href="#__codelineno-14-133"></a><span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">routeExists</span><span class="p">(</span><span class="n">ipRouteClient</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="n">key</span><span class="p">()))</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-134"><a id="__codelineno-14-134" name="__codelineno-14-134" href="#__codelineno-14-134"></a><span class="w">     </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;ip_route_exists - not deleted&quot;</span><span class="p">);</span>
</span><span id="__span-14-135"><a id="__codelineno-14-135" name="__codelineno-14-135" href="#__codelineno-14-135"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-136"><a id="__codelineno-14-136" name="__codelineno-14-136" href="#__codelineno-14-136"></a><span class="p">}</span>
</span><span id="__span-14-137"><a id="__codelineno-14-137" name="__codelineno-14-137" href="#__codelineno-14-137"></a>
</span><span id="__span-14-138"><a id="__codelineno-14-138" name="__codelineno-14-138" href="#__codelineno-14-138"></a><span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-139"><a id="__codelineno-14-139" name="__codelineno-14-139" href="#__codelineno-14-139"></a><span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-140"><a id="__codelineno-14-140" name="__codelineno-14-140" href="#__codelineno-14-140"></a><span class="w">     </span><span class="c1">// set up client side API</span>
</span><span id="__span-14-141"><a id="__codelineno-14-141" name="__codelineno-14-141" href="#__codelineno-14-141"></a><span class="w">     </span><span class="k">auto</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="p">{</span><span class="n">grpc</span><span class="o">::</span><span class="n">CreateChannel</span><span class="p">(</span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">grpc</span><span class="o">::</span><span class="n">InsecureChannelCredentials</span><span class="p">())};</span>
</span><span id="__span-14-142"><a id="__codelineno-14-142" name="__codelineno-14-142" href="#__codelineno-14-142"></a><span class="w">     </span><span class="k">auto</span><span class="w"> </span><span class="n">eapi</span><span class="w"> </span><span class="p">{</span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">EapiMgrService</span><span class="o">::</span><span class="n">Stub</span><span class="p">(</span><span class="n">channel</span><span class="p">)};</span>
</span><span id="__span-14-143"><a id="__codelineno-14-143" name="__codelineno-14-143" href="#__codelineno-14-143"></a><span class="w">     </span><span class="k">auto</span><span class="w"> </span><span class="n">ipRoute</span><span class="w"> </span><span class="p">{</span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">IpRouteMgrService</span><span class="o">::</span><span class="n">Stub</span><span class="p">(</span><span class="n">channel</span><span class="p">)};</span>
</span><span id="__span-14-144"><a id="__codelineno-14-144" name="__codelineno-14-144" href="#__codelineno-14-144"></a>
</span><span id="__span-14-145"><a id="__codelineno-14-145" name="__codelineno-14-145" href="#__codelineno-14-145"></a><span class="w">     </span><span class="c1">// prepare for the RPC call.</span>
</span><span id="__span-14-146"><a id="__codelineno-14-146" name="__codelineno-14-146" href="#__codelineno-14-146"></a><span class="w">     </span><span class="c1">// context allows us to set up metadata, compression or authentication on a</span>
</span><span id="__span-14-147"><a id="__codelineno-14-147" name="__codelineno-14-147" href="#__codelineno-14-147"></a><span class="w">     </span><span class="c1">// per-call basis.</span>
</span><span id="__span-14-148"><a id="__codelineno-14-148" name="__codelineno-14-148" href="#__codelineno-14-148"></a><span class="w">     </span><span class="c1">// see https://grpc.github.io/grpc/cpp/classgrpc_1_1_client_context.html</span>
</span><span id="__span-14-149"><a id="__codelineno-14-149" name="__codelineno-14-149" href="#__codelineno-14-149"></a><span class="w">     </span><span class="n">grpc</span><span class="o">::</span><span class="n">ClientContext</span><span class="w"> </span><span class="n">context</span><span class="p">;</span>
</span><span id="__span-14-150"><a id="__codelineno-14-150" name="__codelineno-14-150" href="#__codelineno-14-150"></a><span class="w">     </span><span class="c1">// generated request and response objects</span>
</span><span id="__span-14-151"><a id="__codelineno-14-151" name="__codelineno-14-151" href="#__codelineno-14-151"></a><span class="w">     </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">RunShowCmdRequest</span><span class="w"> </span><span class="n">request</span><span class="p">;</span>
</span><span id="__span-14-152"><a id="__codelineno-14-152" name="__codelineno-14-152" href="#__codelineno-14-152"></a><span class="w">     </span><span class="n">eos</span><span class="o">::</span><span class="n">remote</span><span class="o">::</span><span class="n">RunShowCmdResponse</span><span class="w"> </span><span class="n">response</span><span class="p">;</span>
</span><span id="__span-14-153"><a id="__codelineno-14-153" name="__codelineno-14-153" href="#__codelineno-14-153"></a><span class="w">     </span><span class="n">request</span><span class="p">.</span><span class="n">set_command</span><span class="p">(</span><span class="s">&quot;show version&quot;</span><span class="p">);</span>
</span><span id="__span-14-154"><a id="__codelineno-14-154" name="__codelineno-14-154" href="#__codelineno-14-154"></a>
</span><span id="__span-14-155"><a id="__codelineno-14-155" name="__codelineno-14-155" href="#__codelineno-14-155"></a><span class="w">     </span><span class="c1">// make the call.</span>
</span><span id="__span-14-156"><a id="__codelineno-14-156" name="__codelineno-14-156" href="#__codelineno-14-156"></a><span class="w">     </span><span class="n">eapi</span><span class="p">.</span><span class="n">run_show_cmd</span><span class="p">(</span><span class="o">&amp;</span><span class="n">context</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">response</span><span class="p">);</span>
</span><span id="__span-14-157"><a id="__codelineno-14-157" name="__codelineno-14-157" href="#__codelineno-14-157"></a><span class="w">     </span><span class="k">auto</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">eapiResponse</span><span class="w"> </span><span class="p">{</span><span class="n">response</span><span class="p">.</span><span class="n">response</span><span class="p">()};</span>
</span><span id="__span-14-158"><a id="__codelineno-14-158" name="__codelineno-14-158" href="#__codelineno-14-158"></a>
</span><span id="__span-14-159"><a id="__codelineno-14-159" name="__codelineno-14-159" href="#__codelineno-14-159"></a><span class="w">     </span><span class="c1">// This particular check is part of the eAPI module</span>
</span><span id="__span-14-160"><a id="__codelineno-14-160" name="__codelineno-14-160" href="#__codelineno-14-160"></a><span class="w">     </span><span class="c1">// see http://aristanetworks.github.io/EosSdk/docs/2.2.0/ref/eapi.html</span>
</span><span id="__span-14-161"><a id="__codelineno-14-161" name="__codelineno-14-161" href="#__codelineno-14-161"></a><span class="w">     </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">eapiResponse</span><span class="p">.</span><span class="n">success</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-162"><a id="__codelineno-14-162" name="__codelineno-14-162" href="#__codelineno-14-162"></a><span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">logic_error</span><span class="p">(</span><span class="w"> </span><span class="n">eapiResponse</span><span class="p">.</span><span class="n">error_message</span><span class="p">()</span><span class="w"> </span><span class="p">);</span>
</span><span id="__span-14-163"><a id="__codelineno-14-163" name="__codelineno-14-163" href="#__codelineno-14-163"></a><span class="w">     </span><span class="p">}</span>
</span><span id="__span-14-164"><a id="__codelineno-14-164" name="__codelineno-14-164" href="#__codelineno-14-164"></a>
</span><span id="__span-14-165"><a id="__codelineno-14-165" name="__codelineno-14-165" href="#__codelineno-14-165"></a><span class="w">     </span><span class="c1">// for a successful show command, responses[0] holds the JSON output.</span>
</span><span id="__span-14-166"><a id="__codelineno-14-166" name="__codelineno-14-166" href="#__codelineno-14-166"></a><span class="w">     </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Response to </span><span class="se">\&quot;</span><span class="s">show version</span><span class="se">\&quot;</span><span class="s">: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">eapiResponse</span><span class="p">.</span><span class="n">responses</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-14-167"><a id="__codelineno-14-167" name="__codelineno-14-167" href="#__codelineno-14-167"></a><span class="w">        </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span><span id="__span-14-168"><a id="__codelineno-14-168" name="__codelineno-14-168" href="#__codelineno-14-168"></a>
</span><span id="__span-14-169"><a id="__codelineno-14-169" name="__codelineno-14-169" href="#__codelineno-14-169"></a><span class="w">     </span><span class="n">createEvpnRoute</span><span class="p">(</span><span class="n">ipRoute</span><span class="p">);</span>
</span><span id="__span-14-170"><a id="__codelineno-14-170" name="__codelineno-14-170" href="#__codelineno-14-170"></a><span class="w">     </span><span class="n">enumerate</span><span class="p">(</span><span class="n">ipRoute</span><span class="p">);</span>
</span><span id="__span-14-171"><a id="__codelineno-14-171" name="__codelineno-14-171" href="#__codelineno-14-171"></a><span class="w">     </span><span class="n">removeEvpnRoute</span><span class="p">(</span><span class="n">ipRoute</span><span class="p">);</span>
</span><span id="__span-14-172"><a id="__codelineno-14-172" name="__codelineno-14-172" href="#__codelineno-14-172"></a><span class="w">     </span><span class="n">enumerate</span><span class="p">(</span><span class="n">ipRoute</span><span class="p">);</span>
</span><span id="__span-14-173"><a id="__codelineno-14-173" name="__codelineno-14-173" href="#__codelineno-14-173"></a><span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-174"><a id="__codelineno-14-174" name="__codelineno-14-174" href="#__codelineno-14-174"></a><span class="w">     </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;call failed: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="sc">&#39;\n&#39;</span><span class="p">;</span>
</span><span id="__span-14-175"><a id="__codelineno-14-175" name="__codelineno-14-175" href="#__codelineno-14-175"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-14-176"><a id="__codelineno-14-176" name="__codelineno-14-176" href="#__codelineno-14-176"></a><span class="p">}</span>
</span></code></pre></div>
<p>Running the program will yield the output, detailing the steps on creating and deleting a route:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>$<span class="w"> </span>./eosrpcclient<span class="w"> </span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>Response<span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;show version&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;mfgName&quot;</span>:<span class="w"> </span><span class="s2">&quot;Arista&quot;</span>,<span class="w"> </span><span class="s2">&quot;modelName&quot;</span>:<span class="w"> </span><span class="s2">&quot;DCS-7060PX4-32-F&quot;</span>,<span class="w"> </span><span class="s2">&quot;hardwareRevision&quot;</span>:<span class="w"> </span><span class="s2">&quot;11.00&quot;</span>,<span class="w"> </span><span class="s2">&quot;serialNumber&quot;</span>:<span class="w"> </span><span class="s2">&quot;JPE19290418&quot;</span>,<span class="w"> </span><span class="s2">&quot;systemMacAddress&quot;</span>:<span class="w"> </span><span class="s2">&quot;fc:bd:67:2b:2d:95&quot;</span>,<span class="w"> </span><span class="s2">&quot;hwMacAddress&quot;</span>:<span class="w"> </span><span class="s2">&quot;fc:bd:67:2b:2d:95&quot;</span>,<span class="w"> </span><span class="s2">&quot;configMacAddress&quot;</span>:<span class="w"> </span><span class="s2">&quot;00:00:00:00:00:00&quot;</span>,<span class="w"> </span><span class="s2">&quot;version&quot;</span>:<span class="w"> </span><span class="s2">&quot;4.28.2F-28045261.eostrunk.1 (engineering build)&quot;</span>,<span class="w"> </span><span class="s2">&quot;architecture&quot;</span>:<span class="w"> </span><span class="s2">&quot;x86_64&quot;</span>,<span class="w"> </span><span class="s2">&quot;internalVersion&quot;</span>:<span class="w"> </span><span class="s2">&quot;4.28.2F-28045261.eostrunk.1&quot;</span>,<span class="w"> </span><span class="s2">&quot;internalBuildId&quot;</span>:<span class="w"> </span><span class="s2">&quot;6505e1eb-b158-4179-9aa0-0b7486239433&quot;</span>,<span class="w"> </span><span class="s2">&quot;imageFormatVersion&quot;</span>:<span class="w"> </span><span class="s2">&quot;3.0&quot;</span>,<span class="w"> </span><span class="s2">&quot;imageOptimization&quot;</span>:<span class="w"> </span><span class="s2">&quot;Default&quot;</span>,<span class="w"> </span><span class="s2">&quot;bootupTimestamp&quot;</span>:<span class="w"> </span><span class="m">1658137083</span>.7456691,<span class="w"> </span><span class="s2">&quot;uptime&quot;</span>:<span class="w"> </span><span class="m">8067</span>.6000000000004,<span class="w"> </span><span class="s2">&quot;memTotal&quot;</span>:<span class="w"> </span><span class="m">8165876</span>,<span class="w"> </span><span class="s2">&quot;memFree&quot;</span>:<span class="w"> </span><span class="m">5713744</span>,<span class="w"> </span><span class="s2">&quot;isIntlVersion&quot;</span>:<span class="w"> </span>false<span class="o">}</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>ip_route_set
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>ip_route_via_set
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>ip_route_exists
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>routes:
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">        </span>key:<span class="o">(</span><span class="nv">pfx</span><span class="o">=</span><span class="m">100</span>.0.0.0/8,pref<span class="o">=</span><span class="m">0</span><span class="o">)</span>,<span class="w"> </span><span class="nv">tag</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>ip_route_via_del
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>ip_route_del
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>!ip_route_exists
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>routes:
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>$
</span></code></pre></div>
<p>To verify the route creation with CLI, we can debug the program and set a breakpoint before each of the new functions.</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>$<span class="w"> </span>gdb<span class="w"> </span>eosrpcclient<span class="w"> </span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>GNU<span class="w"> </span>gdb<span class="w"> </span><span class="o">(</span>GDB<span class="o">)</span><span class="w"> </span>Fedora<span class="w"> </span><span class="m">11</span>.2-2.fc35
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span><span class="m">2022</span><span class="w"> </span>Free<span class="w"> </span>Software<span class="w"> </span>Foundation,<span class="w"> </span>Inc.
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>License<span class="w"> </span>GPLv3+:<span class="w"> </span>GNU<span class="w"> </span>GPL<span class="w"> </span>version<span class="w"> </span><span class="m">3</span><span class="w"> </span>or<span class="w"> </span>later<span class="w"> </span>&lt;http://gnu.org/licenses/gpl.html&gt;
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>This<span class="w"> </span>is<span class="w"> </span>free<span class="w"> </span>software:<span class="w"> </span>you<span class="w"> </span>are<span class="w"> </span>free<span class="w"> </span>to<span class="w"> </span>change<span class="w"> </span>and<span class="w"> </span>redistribute<span class="w"> </span>it.
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>There<span class="w"> </span>is<span class="w"> </span>NO<span class="w"> </span>WARRANTY,<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>extent<span class="w"> </span>permitted<span class="w"> </span>by<span class="w"> </span>law.
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>Type<span class="w"> </span><span class="s2">&quot;show copying&quot;</span><span class="w"> </span>and<span class="w"> </span><span class="s2">&quot;show warranty&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>details.
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>This<span class="w"> </span>GDB<span class="w"> </span>was<span class="w"> </span>configured<span class="w"> </span>as<span class="w"> </span><span class="s2">&quot;x86_64-redhat-linux-gnu&quot;</span>.
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>Type<span class="w"> </span><span class="s2">&quot;show configuration&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>configuration<span class="w"> </span>details.
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>For<span class="w"> </span>bug<span class="w"> </span>reporting<span class="w"> </span>instructions,<span class="w"> </span>please<span class="w"> </span>see:
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>&lt;https://www.gnu.org/software/gdb/bugs/&gt;.
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a>Find<span class="w"> </span>the<span class="w"> </span>GDB<span class="w"> </span>manual<span class="w"> </span>and<span class="w"> </span>other<span class="w"> </span>documentation<span class="w"> </span>resources<span class="w"> </span>online<span class="w"> </span>at:
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="w">    </span>&lt;http://www.gnu.org/software/gdb/documentation/&gt;.
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a>For<span class="w"> </span>help,<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="s2">&quot;help&quot;</span>.
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a>Type<span class="w"> </span><span class="s2">&quot;apropos word&quot;</span><span class="w"> </span>to<span class="w"> </span>search<span class="w"> </span><span class="k">for</span><span class="w"> </span>commands<span class="w"> </span>related<span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;word&quot;</span>...
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a>Reading<span class="w"> </span>symbols<span class="w"> </span>from<span class="w"> </span>eosrpcclient...
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>br<span class="w"> </span>createEvpnRoute
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>Breakpoint<span class="w"> </span><span class="m">1</span><span class="w"> </span>at<span class="w"> </span>0x4099dc
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>br<span class="w"> </span>removeEvpnRoute
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>Breakpoint<span class="w"> </span><span class="m">2</span><span class="w"> </span>at<span class="w"> </span>0x409e6d
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>r
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>Starting<span class="w"> </span>program:<span class="w"> </span>/home/paulo/src/EosRpcClient/build/eosrpcclient<span class="w"> </span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a><span class="o">[</span>New<span class="w"> </span>Thread<span class="w"> </span>0x7ffff6d16640<span class="w"> </span><span class="o">(</span>LWP<span class="w"> </span><span class="m">50219</span><span class="o">)]</span>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a><span class="o">[</span>New<span class="w"> </span>Thread<span class="w"> </span>0x7ffff6515640<span class="w"> </span><span class="o">(</span>LWP<span class="w"> </span><span class="m">50220</span><span class="o">)]</span>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="o">[</span>New<span class="w"> </span>Thread<span class="w"> </span>0x7ffff5d14640<span class="w"> </span><span class="o">(</span>LWP<span class="w"> </span><span class="m">50221</span><span class="o">)]</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a>Response<span class="w"> </span>to<span class="w"> </span><span class="s2">&quot;show version&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;imageFormatVersion&quot;</span>:<span class="w"> </span><span class="s2">&quot;3.0&quot;</span>,<span class="w"> </span><span class="s2">&quot;uptime&quot;</span>:<span class="w"> </span><span class="m">6693</span>.9300000000003,<span class="w"> </span><span class="s2">&quot;modelName&quot;</span>:<span class="w"> </span><span class="s2">&quot;DCS-7280SR-32C2-F&quot;</span>,<span class="w"> </span><span class="s2">&quot;internalVersion&quot;</span>:<span class="w"> </span><span class="s2">&quot;4.28.1F-27290106.eostrunk&quot;</span>,<span class="w"> </span><span class="s2">&quot;memTotal&quot;</span>:<span class="w"> </span><span class="m">8165212</span>,<span class="w"> </span><span class="s2">&quot;mfgName&quot;</span>:<span class="w"> </span><span class="s2">&quot;Arista&quot;</span>,<span class="w"> </span><span class="s2">&quot;serialNumber&quot;</span>:<span class="w"> </span><span class="s2">&quot;JAS17450022&quot;</span>,<span class="w"> </span><span class="s2">&quot;systemMacAddress&quot;</span>:<span class="w"> </span><span class="s2">&quot;74:83:ef:01:80:56&quot;</span>,<span class="w"> </span><span class="s2">&quot;bootupTimestamp&quot;</span>:<span class="w"> </span><span class="m">1652463541</span>.5252528,<span class="w"> </span><span class="s2">&quot;memFree&quot;</span>:<span class="w"> </span><span class="m">5481240</span>,<span class="w"> </span><span class="s2">&quot;version&quot;</span>:<span class="w"> </span><span class="s2">&quot;4.28.1F-27290106.eostrunk (engineering build)&quot;</span>,<span class="w"> </span><span class="s2">&quot;configMacAddress&quot;</span>:<span class="w"> </span><span class="s2">&quot;00:00:00:00:00:00&quot;</span>,<span class="w"> </span><span class="s2">&quot;isIntlVersion&quot;</span>:<span class="w"> </span>false,<span class="w"> </span><span class="s2">&quot;imageOptimization&quot;</span>:<span class="w"> </span><span class="s2">&quot;Default&quot;</span>,<span class="w"> </span><span class="s2">&quot;internalBuildId&quot;</span>:<span class="w"> </span><span class="s2">&quot;6d0e8967-f438-4e05-a8d2-176df292e4b6&quot;</span>,<span class="w"> </span><span class="s2">&quot;hardwareRevision&quot;</span>:<span class="w"> </span><span class="s2">&quot;20.00&quot;</span>,<span class="w"> </span><span class="s2">&quot;hwMacAddress&quot;</span>:<span class="w"> </span><span class="s2">&quot;74:83:ef:01:80:56&quot;</span>,<span class="w"> </span><span class="s2">&quot;architecture&quot;</span>:<span class="w"> </span><span class="s2">&quot;x86_64&quot;</span><span class="o">}</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a>
</span><span id="__span-16-30"><a id="__codelineno-16-30" name="__codelineno-16-30" href="#__codelineno-16-30"></a>Thread<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;eosrpcclient&quot;</span><span class="w"> </span>hit<span class="w"> </span>Breakpoint<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>0x00000000004099dc<span class="w"> </span><span class="k">in</span><span class="w"> </span>createEvpnRoute<span class="o">(</span>std::shared_ptr&lt;grpc::Channel&gt;<span class="w"> </span>const<span class="p">&amp;</span><span class="o">)</span><span class="w"> </span><span class="o">()</span>
</span><span id="__span-16-31"><a id="__codelineno-16-31" name="__codelineno-16-31" href="#__codelineno-16-31"></a><span class="o">(</span>gdb<span class="o">)</span>
</span></code></pre></div>
<p>At this point, we can verify on the switch there are no EVPN routes:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>#show vxlan vni
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>VNI to VLAN Mapping for Vxlan1
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>VNI            VLAN       Source       Interface       802.1Q Tag
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>-------------- ---------- ------------ --------------- ----------
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>14455119       2516       static       Vxlan1          2516      
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>VNI to dynamic VLAN Mapping for Vxlan1
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>VNI       VLAN       VRF       Source       
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>--------- ---------- --------- ------------
</span></code></pre></div>
<p>Continuing the program:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>c
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>Continuing.
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="o">[</span>New<span class="w"> </span>Thread<span class="w"> </span>0x7ffff5513640<span class="w"> </span><span class="o">(</span>LWP<span class="w"> </span><span class="m">50911</span><span class="o">)]</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>Thread<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s2">&quot;eosrpcclient&quot;</span><span class="w"> </span>hit<span class="w"> </span>Breakpoint<span class="w"> </span><span class="m">2</span>,<span class="w"> </span>0x0000000000409e6d<span class="w"> </span><span class="k">in</span><span class="w"> </span>removeEvpnRoute<span class="o">(</span>std::shared_ptr&lt;grpc::Channel&gt;<span class="w"> </span>const<span class="p">&amp;</span><span class="o">)</span><span class="w"> </span><span class="o">()</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>
</span></code></pre></div>
<p>We can see a new VNI 99 created:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>#show vxlan vni
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>VNI to VLAN Mapping for Vxlan1
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>VNI            VLAN       Source       Interface       802.1Q Tag
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>-------------- ---------- ------------ --------------- ----------
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>14455119       2516       static       Vxlan1          2516
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>VNI to dynamic VLAN Mapping for Vxlan1
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>VNI       VLAN       VRF       Source 
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>--------- ---------- --------- ------------ 
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>99        4090                 evpn
</span></code></pre></div>
<p>Continuing once again to remove the route:</p>
<div class="language-sh highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>c
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a>Continuing.
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="o">[</span>Thread<span class="w"> </span>0x7ffff5513640<span class="w"> </span><span class="o">(</span>LWP<span class="w"> </span><span class="m">50911</span><span class="o">)</span><span class="w"> </span>exited<span class="o">]</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="o">[</span>Thread<span class="w"> </span>0x7ffff5d14640<span class="w"> </span><span class="o">(</span>LWP<span class="w"> </span><span class="m">50221</span><span class="o">)</span><span class="w"> </span>exited<span class="o">]</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="o">[</span>Thread<span class="w"> </span>0x7ffff6515640<span class="w"> </span><span class="o">(</span>LWP<span class="w"> </span><span class="m">50220</span><span class="o">)</span><span class="w"> </span>exited<span class="o">]</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="o">[</span>Thread<span class="w"> </span>0x7ffff6d16640<span class="w"> </span><span class="o">(</span>LWP<span class="w"> </span><span class="m">50219</span><span class="o">)</span><span class="w"> </span>exited<span class="o">]</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="o">[</span>Inferior<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>process<span class="w"> </span><span class="m">49995</span><span class="o">)</span><span class="w"> </span>exited<span class="w"> </span>normally<span class="o">]</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>
</span></code></pre></div>
<p>And verifying the route has been removed:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>#show vxlan vni
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>VNI to VLAN Mapping for Vxlan1
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>VNI            VLAN       Source       Interface       802.1Q Tag
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>-------------- ---------- ------------ --------------- ----------
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>14455119       2516       static       Vxlan1          2516
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>VNI to dynamic VLAN Mapping for Vxlan1
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>VNI       VLAN       VRF       Source
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>--------- ---------- --------- ------------ 
</span></code></pre></div>
<h2 id="known-issues-and-limitations">Known Issues and Limitations<a class="headerlink" href="#known-issues-and-limitations" title="Permanent link">¶</a></h2>
<h3 id="eossdk-default-fields">EosSdk default fields<a class="headerlink" href="#eossdk-default-fields" title="Permanent link">¶</a></h3>
<p>From release  4.29.2F onwards, the fields listed below have been made explicitly optional in the proto files, with the purpose of differentiating between a field that has been explicitly set to zero from an unset field. Unset fields are mapped to EOS SDK default values.</p>
<p>Some of the types in EosSdk have non-zero default values for some of their fields. Most of the time EosSdkRpc uses default values of zero (or the equivalent). Therefore, when using EosSdkRpc if these fields with non-zero default values are not explicitly specified there can be a difference in behavior when setting the same configuration in EosSdk and EosSdkRpc. A list of the supported fields in EosSdkRpc which have non-zero default values in EosSdk is provided. The equivalent to the EosSdk default value is also specified for each field. These values can be manually set when using EosSdkRpc to ensure consistency with what their values in EosSdk would be. Note that if the client is already explicitly setting values for these fields in EosSdk/EosSdkRpc the default values do not matter.</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Message</th>
<th>Field</th>
<th>Equivalent EosSdk Default Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>acl_types.proto</td>
<td>AclTtlSpec</td>
<td>oper</td>
<td>ACL_RANGE_ANY</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclPortSpec</td>
<td>oper</td>
<td>ACL_RANGE_ANY</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclRuleBase</td>
<td>action</td>
<td>ACL_PERMIT</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclRuleIp</td>
<td>vlan_mask</td>
<td>xFFF</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclRuleIp</td>
<td>inner_vlan_mask</td>
<td>0xFFF</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclRuleIp</td>
<td>ip_type</td>
<td>ACL_IP_TYPE_ANY</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclRuleIp</td>
<td>icmp_type</td>
<td>ALL_ICMP (65535)</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclRuleIp</td>
<td>icmp_code</td>
<td>ALL_ICMP (65535)</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclRuleEth</td>
<td>vlan_mask</td>
<td>0xFFF</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclRuleEth</td>
<td>inner_vlan_mask</td>
<td>0xFFF</td>
</tr>
<tr>
<td>acl_types.proto</td>
<td>AclRuleEth</td>
<td>eth_protocol</td>
<td>0xFFFFFFFF</td>
</tr>
<tr>
<td>ip_route_types.proto</td>
<td>IpRouteKey</td>
<td>preference</td>
<td>1</td>
</tr>
<tr>
<td>macsec_types.proto</td>
<td>MacsecProfile</td>
<td>key_server_priority</td>
<td>16</td>
</tr>
<tr>
<td>macsec_types.proto</td>
<td>MacsecProfile</td>
<td>mka_life_time*</td>
<td>6</td>
</tr>
<tr>
<td>macsec_types.proto</td>
<td>MacsecProfile</td>
<td>cipher*</td>
<td>GCM_AES_XPN_128</td>
</tr>
<tr>
<td>macsec_types.proto</td>
<td>MacsecProfile</td>
<td>traffic_policy</td>
<td>TRAFFIC_POLICY_ACTIVE_SAK</td>
</tr>
<tr>
<td>macsec_types.proto</td>
<td>MacsecProfile</td>
<td>replay_protection</td>
<td>True</td>
</tr>
<tr>
<td>nexthop_group_types.proto</td>
<td>NexthopGroup</td>
<td>ttl</td>
<td>64</td>
</tr>
<tr>
<td>policy_map_types.proto</td>
<td>PolicyMapRule</td>
<td>policy_map_rule_type</td>
<td>POLICY_RULE_TYPE_CLASSMAP</td>
</tr>
</tbody>
</table>
<p>*The default value of 0 in the EosSdkRpc will automatically be replaced by the EosSdk default value. </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../errorhandling/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Error handling">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Error handling
              </div>
            </div>
          </a>
        
        
          
          <a href="../limitations/" class="md-footer__link md-footer__link--next" aria-label="Next: Limitations">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Limitations
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Arista Networks, Inc. All rights reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/aristanetworks/eossdkrpc" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M202.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M496 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.arista.com" target="_blank" rel="noopener" title="www.arista.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M351.9 280H161c2.9 64.5 17.2 123.9 37.5 167.4 11.4 24.5 23.7 41.8 35.1 52.4 11.2 10.5 18.9 12.2 22.9 12.2s11.7-1.7 22.9-12.2c11.4-10.6 23.7-28 35.1-52.4 20.3-43.5 34.6-102.9 37.5-167.4zm-191-48h190.9c-2.8-64.5-17.1-123.9-37.4-167.4-11.4-24.4-23.7-41.8-35.1-52.4C268.1 1.7 260.4 0 256.4 0s-11.7 1.7-22.9 12.2c-11.4 10.6-23.7 28-35.1 52.4-20.3 43.5-34.6 102.9-37.5 167.4m-48 0c3.5-85.6 25.6-165.1 57.9-217.3C78.7 47.3 10.9 131.2 1.5 232zM1.5 280c9.4 100.8 77.2 184.7 169.3 217.3-32.3-52.2-54.4-131.7-57.9-217.3zm398.4 0c-3.5 85.6-25.6 165.1-57.9 217.3 92.1-32.7 159.9-116.5 169.3-217.3zm111.4-48C501.9 131.2 434.1 47.3 342 14.7c32.3 52.2 54.4 131.7 57.9 217.3z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["header.autohide", "navigation.tabs", "navigation.indexes", "navigation.instant", "navigation.top", "navigation.footer", "content.code.copy", "content.code.select"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>