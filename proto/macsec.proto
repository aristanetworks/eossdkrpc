// Copyright (c) 2021 Arista Networks, Inc.  All rights reserved.
// Arista Networks, Inc. Confidential and Proprietary.

syntax = "proto3";

package eos.remote;

import "defs.proto";
import "intf.proto";
import "macsec_types.proto";

service MacsecMgrService {
   rpc watch( WatchMacsecRequest ) returns ( stream MacsecEvent ) {}
   
   rpc exists( MacsecProfileExistsRequest ) returns ( MacsecProfileExistsResponse ) {}

   rpc macsec_profile( MacsecProfileRequest ) returns ( MacsecProfileResponse ) {}

   rpc profile_set( MacsecProfileSetRequest ) returns ( MacsecProfileSetResponse ){}

   rpc bulk_profile_set( BulkMacsecProfileSetRequest ) returns ( BulkMacsecProfileSetResponse ) {}

   rpc profile_del( MacsecProfileDelRequest ) returns ( MacsecProfileDelResponse ) {}

   rpc bulk_profile_del( BulkMacsecProfileDelRequest ) returns ( BulkMacsecProfileDelResponse ) {}

   rpc intf_profile( MacsecIntfProfileRequest ) returns ( MacsecIntfProfileResponse ) {}

   rpc intf_profile_is( MacsecIntfProfileIsRequest ) returns ( MacsecIntfProfileIsResponse ) {}

   rpc bulk_intf_profile_is( BulkMacsecIntfProfileIsRequest ) returns ( BulkMacsecIntfProfileIsResponse ) {}

   rpc macsec_capable( MacsecCapableRequest ) returns ( MacsecCapableResponse ) {}

   rpc intf_status( MacsecIntfStatusRequest ) returns ( MacsecIntfStatusResponse ) {}

   rpc intf_counters( MacsecIntfCountersRequest ) returns ( MacsecIntfCountersResponse ) {}

   rpc macsec_profiles( MacsecProfilesRequest ) returns ( stream MacsecProfilesResponse ) {}

   rpc macsec_intf_statuses( MacsecIntfStatusesRequest ) returns ( stream MacsecIntfStatusesResponse ) {}
}

message WatchMacsecRequest {
   oneof overloads {
      bool all_intfs = 1;
      IntfId intf_id = 2;
   }
}

message MacsecEvent {
   IntfId intf_id = 1;
   MacsecIntfKeyStatus status = 2;
   MacsecIntfKeyStatus key_status = 3;
   MacsecIntfTrafficStatus traffic_status = 4;

}

message MacsecProfileExistsRequest {
   string profile_name = 1;
}

message MacsecProfileExistsResponse {
   bool exists = 1;
}

message MacsecProfileRequest {
   string profile_name = 1;
}

message MacsecProfileResponse {
   MacsecProfile profile = 1;
}

message MacsecProfileSetRequest {
   MacsecProfile profile = 1;
}

message MacsecProfileSetResponse {
   RpcResponseStatus response_status = 1;
}

message BulkMacsecProfileSetRequest {
   repeated MacsecProfile profile = 1;
}

message BulkMacsecProfileSetResponse {
   repeated RpcResponseStatus response_status = 1;
}

message MacsecProfileDelRequest {
   MacsecProfile profile = 1;
}

message MacsecProfileDelResponse {
   RpcResponseStatus response_status = 1;
}

message BulkMacsecProfileDelRequest {
   MacsecProfile profile = 1;
}

message BulkMacsecProfileDelResponse {
   repeated RpcResponseStatus response_status = 1;
}

message MacsecProfileName {
   string value = 1;
}

message MacsecKey {
   string cak = 1;
   string ckn = 2;
   bool encoded = 3;
}

message MacsecProfile {
   string profile_name = 1;
   MacsecKey primary_key = 2;
   MacsecKey fallback_key = 3;
   uint32 key_server_priority = 4;
   uint32 rekey_period = 5;
   uint32 mka_life_time = 6;
   MacsecCipherSuite cipher = 7;
   bool dot1x = 8;
   bool include_sci = 9;
   bool bypass_lldp = 10;
   MacsecBypass lldp_bypass_level = 11;
   MacsecProfileTrafficPolicy traffic_policy = 12;
   bool allow_unprotected = 13;
   bool replay_protection = 14;
   uint32 replay_protection_window = 15;
   bool key_retirement_immediate = 16;
   repeated IntfId intfs = 17;
}
message MacsecIntfProfileRequest {
   string intf_id = 1;
}

message MacsecIntfProfileResponse {
   string macsec_profile_name = 1;
}

message MacsecIntfProfileIsRequest {
   IntfId intf_id = 1;
   string mac_sec_profile_name = 2;
}

message MacsecIntfProfileIsResponse {
   RpcResponseStatus response_status = 1;
}

message BulkMacsecIntfProfileIsRequest {
   repeated MacsecIntfProfileIsRequest intf_profiles = 1;
}

message BulkMacsecIntfProfileIsResponse {
   repeated RpcResponseStatus response_status = 1;
}

message MacsecCapableRequest {
   string intf_id = 1;
}

message MacsecCapableResponse {
   bool macsec_capable = 1;
}

message MacsecIntfStatusRequest {
   string intf_id = 1;
}

message MacsecIntfStatusResponse {
   MacsecIntfKeyStatus status = 1;
   MacsecIntfKeyStatus key_status = 2;
   MacsecIntfTrafficStatus traffic_status = 3;
}

message MacsecIntfCountersRequest {
   string intf_id = 1;
}

message MacsecIntfCountersResponse {
   uint64 out_pkts_encrypted = 1;
   uint64 out_octets_encrypted = 2;
   uint64 in_pkts_decrypted = 3;
   uint64 in_octets_decrypted = 4;
   uint64 in_pkts_not_valid = 5;
}

message MacsecProfilesRequest {}

message MacsecProfilesResponse {
   MacsecProfile profile = 1;
}

message MacsecIntfStatusesRequest {}

message MacsecIntfStatusesResponse {
   MacsecIntfKeyStatus status = 1;
   MacsecIntfKeyStatus key_status = 2;
   MacsecIntfTrafficStatus traffic_status = 3;
}
